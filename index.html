<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard IOE - Operaciones Estad√≠sticas 2014-2023</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f5f7fa;
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            color: white;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .section-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        .metrics-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease;
            border-top: 5px solid #3498db;
        }

        .metric-card.total {
            border-top: 5px solid #e74c3c;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #3498db;
            margin: 10px 0;
        }

        .metric-card.total .metric-value {
            color: #e74c3c;
            font-size: 3em;
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 1em;
            margin-bottom: 5px;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            position: relative;
        }

        .chart-title {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .data-table th {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .data-table tr:hover {
            background-color: #f5f9ff;
        }

        .year-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .year-section.active {
            display: block;
        }

        .year-header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .year-title {
            font-size: 1.8em;
            font-weight: 600;
        }

        .year-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .year-metric {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .year-metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }

        .year-metric-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .year-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .year-tab {
            padding: 10px 20px;
            border: none;
            background: #ecf0f1;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            min-width: 80px;
        }

        .year-tab:hover {
            background: #3498db;
            color: white;
        }

        .year-tab.active {
            background: #3498db;
            color: white;
            box-shadow: 0 3px 10px rgba(52, 152, 219, 0.3);
        }

        .year-tab.total {
            background: #e74c3c;
            color: white;
        }

        .top-organismos {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .org-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }

        .org-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 0.95em;
        }

        .org-count {
            color: #3498db;
            font-size: 1.2em;
            font-weight: bold;
        }

        .org-percent {
            color: #7f8c8d;
            font-size: 0.85em;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            margin-top: 30px;
            font-size: 0.9em;
        }

        .methodology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .methodology-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .methodology-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #3498db;
        }

        .methodology-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            .metric-value {
                font-size: 2em;
            }
            
            .year-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Dashboard IOE - Operaciones Estad√≠sticas</h1>
            <p class="subtitle">Inventario de Operaciones Estad√≠sticas 2014-2023 - Paraguay</p>
            <p>Per√≠odo analizado: 2014-2023 | Total de registros: 3,366</p>
        </header>

        <div class="year-tabs">
            <button class="year-tab total active" onclick="showYear('total')">üìà TOTAL</button>
            <button class="year-tab" onclick="showYear(2014)">2014</button>
            <button class="year-tab" onclick="showYear(2015)">2015</button>
            <button class="year-tab" onclick="showYear(2016)">2016</button>
            <button class="year-tab" onclick="showYear(2017)">2017</button>
            <button class="year-tab" onclick="showYear(2018)">2018</button>
            <button class="year-tab" onclick="showYear(2019)">2019</button>
            <button class="year-tab" onclick="showYear(2020)">2020</button>
            <button class="year-tab" onclick="showYear(2021)">2021</button>
            <button class="year-tab" onclick="showYear(2022)">2022</button>
            <button class="year-tab" onclick="showYear(2023)">2023</button>
        </div>

        <!-- SECCI√ìN TOTAL GENERAL -->
        <div id="total-section" class="year-section active">
            <div class="section-title">
                üìä RESUMEN TOTAL (2014-2023)
            </div>

            <div class="metrics-container">
                <div class="metric-card total">
                    <div class="metric-label">Operaciones Estad√≠sticas Totales</div>
                    <div class="metric-value">3,366</div>
                    <div class="metric-desc">Registros acumulados 2014-2023</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Distribuci√≥n INE vs Otros</div>
                    <div class="metric-value">21.3% / 78.7%</div>
                    <div class="metric-desc">INE: 716 | Otros: 2,650</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Difusi√≥n P√∫blica</div>
                    <div class="metric-value">74.5%</div>
                    <div class="metric-desc">2,508 operaciones</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">üìà Distribuci√≥n Anual de Operaciones</h3>
                    <canvas id="totalYearlyChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">üèõÔ∏è Distribuci√≥n por Servicio Estad√≠stico</h3>
                    <canvas id="totalServiceChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìã Top 10 Organismos con m√°s Operaciones (Total)</h3>
                <div class="top-organismos" id="totalTopOrganismos">
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üåç Evoluci√≥n de Dominios Tem√°ticos (2014-2023)</h3>
                <canvas id="totalDomainEvolutionChart"></canvas>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üîß Evoluci√≥n de Metodolog√≠as (2014-2023)</h3>
                <canvas id="totalMethodologyEvolutionChart"></canvas>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìä Resumen Detallado por A√±o</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>A√±o</th>
                            <th>Total Operaciones</th>
                            <th>INE</th>
                            <th>Otros Organismos</th>
                            <th>% Difusi√≥n P√∫blica</th>
                            <th>% Demograf√≠a</th>
                            <th>% Fuentes Administrativas</th>
                        </tr>
                    </thead>
                    <tbody id="totalYearlyTable">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SECCIONES POR A√ëO (2014-2023) -->
        <div id="year-sections">
        </div>

        <footer>
            <p>¬© 2025 Dashboard IOE - Datos del Inventario de Operaciones Estad√≠sticas del Paraguay</p>
            <p>Fuente: INE - Base de datos 2014-2023 | Procesado el 30-DEC-2025</p>
        </footer>
    </div>

    <script>
        const data = {
            total: 3366,
            years: [2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023],
            
            yearlyData: {
                2014: {
                    total: 241,
                    ine: 75,
                    others: 166,
                    difusionPublica: 70.1,
                    demografia: 52.3,
                    economica: 32.4,
                    ambiente: 12.9,
                    metodologia: 2.9,
                    obtencionDirecta: 36.1,
                    fuentesAdministrativas: 34.0,
                    estadisticasDerivadas: 26.1,
                    infraestructura: 2.9,
                    otrasMetodologias: 0.8,
                    topOrganismos: [
                        {name: "INE", count: 75, percent: 31.1},
                        {name: "MSPyBS", count: 34, percent: 14.1},
                        {name: "MEC", count: 9, percent: 3.7},
                        {name: "UNA", count: 11, percent: 4.6},
                        {name: "MOPC", count: 7, percent: 2.9},
                        {name: "MADES", count: 7, percent: 2.9},
                        {name: "MEF", count: 7, percent: 2.9},
                        {name: "INFONA", count: 7, percent: 2.9},
                        {name: "BCP", count: 26, percent: 10.8},
                        {name: "MDI", count: 6, percent: 2.5}
                    ]
                },
                2015: {
                    total: 291,
                    ine: 85,
                    others: 206,
                    difusionPublica: 72.9,
                    demografia: 62.2,
                    economica: 34.4,
                    ambiente: 14.8,
                    metodologia: 5.8,
                    obtencionDirecta: 34.7,
                    fuentesAdministrativas: 32.6,
                    estadisticasDerivadas: 26.5,
                    infraestructura: 4.1,
                    otrasMetodologias: 2.1,
                    topOrganismos: [
                        {name: "INE", count: 85, percent: 29.2},
                        {name: "MSPyBS", count: 45, percent: 15.5},
                        {name: "MEC", count: 9, percent: 3.1},
                        {name: "UNA", count: 14, percent: 4.8},
                        {name: "MOPC", count: 8, percent: 2.7},
                        {name: "MADES", count: 7, percent: 2.4},
                        {name: "MEF", count: 8, percent: 2.7},
                        {name: "MTESS", count: 5, percent: 1.7},
                        {name: "BCP", count: 27, percent: 9.3},
                        {name: "INFONA", count: 10, percent: 3.4}
                    ]
                },
                2016: {
                    total: 264,
                    ine: 72,
                    others: 192,
                    difusionPublica: 74.2,
                    demografia: 70.1,
                    economica: 39.0,
                    ambiente: 11.0,
                    metodologia: 7.2,
                    obtencionDirecta: 33.0,
                    fuentesAdministrativas: 30.7,
                    estadisticasDerivadas: 29.9,
                    infraestructura: 3.8,
                    otrasMetodologias: 2.7,
                    topOrganismos: [
                        {name: "INE", count: 72, percent: 27.3},
                        {name: "MSPyBS", count: 38, percent: 14.4},
                        {name: "MEC", count: 10, percent: 3.8},
                        {name: "UNA", count: 13, percent: 4.9},
                        {name: "MOPC", count: 10, percent: 3.8},
                        {name: "MTESS", count: 7, percent: 2.7},
                        {name: "MEF", count: 10, percent: 3.8},
                        {name: "BCP", count: 27, percent: 10.2},
                        {name: "INFONA", count: 10, percent: 3.8},
                        {name: "MIC", count: 2, percent: 0.8}
                    ]
                },
                2017: {
                    total: 311,
                    ine: 74,
                    others: 237,
                    difusionPublica: 78.5,
                    demografia: 71.7,
                    economica: 36.3,
                    ambiente: 12.2,
                    metodologia: 8.7,
                    obtencionDirecta: 30.9,
                    fuentesAdministrativas: 33.4,
                    estadisticasDerivadas: 26.0,
                    infraestructura: 5.1,
                    otrasMetodologias: 4.5,
                    topOrganismos: [
                        {name: "INE", count: 74, percent: 23.8},
                        {name: "MSPyBS", count: 50, percent: 16.1},
                        {name: "MEC", count: 7, percent: 2.3},
                        {name: "UNA", count: 15, percent: 4.8},
                        {name: "MOPC", count: 9, percent: 2.9},
                        {name: "MTESS", count: 10, percent: 3.2},
                        {name: "MEF", count: 11, percent: 3.5},
                        {name: "BCP", count: 27, percent: 8.7},
                        {name: "INFONA", count: 10, percent: 3.2},
                        {name: "MDI", count: 9, percent: 2.9}
                    ]
                },
                2018: {
                    total: 346,
                    ine: 74,
                    others: 272,
                    difusionPublica: 74.0,
                    demografia: 67.1,
                    economica: 39.0,
                    ambiente: 13.9,
                    metodologia: 9.2,
                    obtencionDirecta: 25.4,
                    fuentesAdministrativas: 40.5,
                    estadisticasDerivadas: 24.9,
                    infraestructura: 5.5,
                    otrasMetodologias: 3.8,
                    topOrganismos: [
                        {name: "INE", count: 74, percent: 21.4},
                        {name: "MSPyBS", count: 50, percent: 14.5},
                        {name: "MOPC", count: 17, percent: 4.9},
                        {name: "UNA", count: 12, percent: 3.5},
                        {name: "MTESS", count: 13, percent: 3.8},
                        {name: "MEF", count: 11, percent: 3.2},
                        {name: "BCP", count: 27, percent: 7.8},
                        {name: "INFONA", count: 10, percent: 2.9},
                        {name: "MDI", count: 8, percent: 2.3},
                        {name: "SENAD", count: 8, percent: 2.3}
                    ]
                },
                2019: {
                    total: 349,
                    ine: 68,
                    others: 281,
                    difusionPublica: 73.9,
                    demografia: 66.5,
                    economica: 39.8,
                    ambiente: 13.2,
                    metodologia: 9.5,
                    obtencionDirecta: 23.2,
                    fuentesAdministrativas: 44.4,
                    estadisticasDerivadas: 22.3,
                    infraestructura: 6.3,
                    otrasMetodologias: 3.7,
                    topOrganismos: [
                        {name: "INE", count: 68, percent: 19.5},
                        {name: "MSPyBS", count: 45, percent: 12.9},
                        {name: "MOPC", count: 17, percent: 4.9},
                        {name: "UNA", count: 12, percent: 3.4},
                        {name: "MTESS", count: 14, percent: 4.0},
                        {name: "MEF", count: 11, percent: 3.2},
                        {name: "BCP", count: 29, percent: 8.3},
                        {name: "INFONA", count: 10, percent: 2.9},
                        {name: "MDI", count: 8, percent: 2.3},
                        {name: "SENAD", count: 8, percent: 2.3}
                    ]
                },
                2020: {
                    total: 390,
                    ine: 71,
                    others: 319,
                    difusionPublica: 74.9,
                    demografia: 65.6,
                    economica: 39.2,
                    ambiente: 12.6,
                    metodologia: 8.7,
                    obtencionDirecta: 20.8,
                    fuentesAdministrativas: 42.8,
                    estadisticasDerivadas: 26.2,
                    infraestructura: 6.2,
                    otrasMetodologias: 4.1,
                    topOrganismos: [
                        {name: "INE", count: 71, percent: 18.2},
                        {name: "MSPyBS", count: 41, percent: 10.5},
                        {name: "MOPC", count: 17, percent: 4.4},
                        {name: "MTESS", count: 28, percent: 7.2},
                        {name: "MEF", count: 31, percent: 7.9},
                        {name: "BCP", count: 29, percent: 7.4},
                        {name: "UNA", count: 13, percent: 3.3},
                        {name: "INFONA", count: 10, percent: 2.6},
                        {name: "MIC", count: 4, percent: 1.0},
                        {name: "SENAD", count: 8, percent: 2.1}
                    ]
                },
                2021: {
                    total: 395,
                    ine: 78,
                    others: 317,
                    difusionPublica: 75.9,
                    demografia: 67.6,
                    economica: 39.5,
                    ambiente: 10.6,
                    metodologia: 8.6,
                    obtencionDirecta: 21.3,
                    fuentesAdministrativas: 42.3,
                    estadisticasDerivadas: 27.1,
                    infraestructura: 5.8,
                    otrasMetodologias: 3.5,
                    topOrganismos: [
                        {name: "INE", count: 78, percent: 19.7},
                        {name: "MSPyBS", count: 43, percent: 10.9},
                        {name: "MOPC", count: 17, percent: 4.3},
                        {name: "MTESS", count: 24, percent: 6.1},
                        {name: "MEF", count: 28, percent: 7.1},
                        {name: "BCP", count: 37, percent: 9.4},
                        {name: "UNA", count: 13, percent: 3.3},
                        {name: "INFONA", count: 10, percent: 2.5},
                        {name: "MIC", count: 2, percent: 0.5},
                        {name: "SENAD", count: 8, percent: 2.0}
                    ]
                },
                2022: {
                    total: 389,
                    ine: 65,
                    others: 324,
                    difusionPublica: 76.9,
                    demografia: 62.5,
                    economica: 39.8,
                    ambiente: 11.1,
                    metodologia: 9.0,
                    obtencionDirecta: 18.0,
                    fuentesAdministrativas: 42.9,
                    estadisticasDerivadas: 29.8,
                    infraestructura: 5.9,
                    otrasMetodologias: 3.3,
                    topOrganismos: [
                        {name: "INE", count: 65, percent: 16.7},
                        {name: "MSPyBS", count: 47, percent: 12.1},
                        {name: "MOPC", count: 22, percent: 5.7},
                        {name: "MTESS", count: 26, percent: 6.7},
                        {name: "MEF", count: 26, percent: 6.7},
                        {name: "BCP", count: 36, percent: 9.3},
                        {name: "UNA", count: 13, percent: 3.3},
                        {name: "INFONA", count: 10, percent: 2.6},
                        {name: "MIC", count: 5, percent: 1.3},
                        {name: "SENAD", count: 7, percent: 1.8}
                    ]
                },
                2023: {
                    total: 390,
                    ine: 54,
                    others: 336,
                    difusionPublica: 72.3,
                    demografia: 59.5,
                    economica: 44.6,
                    ambiente: 10.0,
                    metodologia: 8.5,
                    obtencionDirecta: 19.0,
                    fuentesAdministrativas: 46.2,
                    estadisticasDerivadas: 26.2,
                    infraestructura: 6.2,
                    otrasMetodologias: 2.6,
                    topOrganismos: [
                        {name: "INE", count: 54, percent: 13.8},
                        {name: "MSPyBS", count: 41, percent: 10.5},
                        {name: "MOPC", count: 22, percent: 5.6},
                        {name: "MTESS", count: 22, percent: 5.6},
                        {name: "MEF", count: 24, percent: 6.2},
                        {name: "BCP", count: 38, percent: 9.7},
                        {name: "UNA", count: 13, percent: 3.3},
                        {name: "MIC", count: 9, percent: 2.3},
                        {name: "MDP", count: 9, percent: 2.3},
                        {name: "SENAD", count: 3, percent: 0.8}
                    ]
                }
            },
            
            averages: {
                demografia: 64.7,
                economica: 38.8,
                ambiente: 12.1,
                metodologia: 8.1,
                obtencionDirecta: 25.2,
                fuentesAdministrativas: 39.8,
                estadisticasDerivadas: 26.5,
                infraestructura: 5.3,
                otrasMetodologias: 3.2
            }
        };

        function showYear(year) {
            document.querySelectorAll('.year-tab').forEach(tab => {
                tab.classList.remove('active');
                if ((year === 'total' && tab.classList.contains('total')) || 
                    tab.textContent.includes(year.toString())) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.year-section').forEach(section => {
                section.classList.remove('active');
            });
            
            if (year === 'total') {
                document.getElementById('total-section').classList.add('active');
            } else {
                const yearSection = document.getElementById(`year-${year}-section`);
                if (yearSection) {
                    yearSection.classList.add('active');
                }
            }
        }

        function createYearSections() {
            const container = document.getElementById('year-sections');
            
            data.years.forEach(year => {
                const yearData = data.yearlyData[year];
                
                const section = document.createElement('div');
                section.id = `year-${year}-section`;
                section.className = 'year-section';
                
                section.innerHTML = `
                    <div class="year-header">
                        <div class="year-title">üìÖ A√±o ${year} - ${yearData.total} Operaciones Estad√≠sticas</div>
                        <div style="font-size: 1.2em;">${yearData.total} registros</div>
                    </div>
                    
                    <div class="year-metrics">
                        <div class="year-metric">
                            <div class="year-metric-label">Distribuci√≥n INE vs Otros</div>
                            <div class="year-metric-value">${((yearData.ine/yearData.total)*100).toFixed(1)}% / ${((yearData.others/yearData.total)*100).toFixed(1)}%</div>
                            <div style="font-size: 0.8em; color: #7f8c8d;">INE: ${yearData.ine} | Otros: ${yearData.others}</div>
                        </div>
                        <div class="year-metric">
                            <div class="year-metric-label">Difusi√≥n P√∫blica</div>
                            <div class="year-metric-value">${yearData.difusionPublica}%</div>
                            <div style="font-size: 0.8em; color: #7f8c8d;">${Math.round(yearData.total * yearData.difusionPublica / 100)} operaciones</div>
                        </div>
                        <div class="year-metric">
                            <div class="year-metric-label">Dominio Principal</div>
                            <div class="year-metric-value">Demograf√≠a</div>
                            <div style="font-size: 0.8em; color: #7f8c8d;">${yearData.demografia}% del total</div>
                        </div>
                        <div class="year-metric">
                            <div class="year-metric-label">Metodolog√≠a Principal</div>
                            <div class="year-metric-value">${yearData.fuentesAdministrativas > yearData.obtencionDirecta && yearData.fuentesAdministrativas > yearData.estadisticasDerivadas ? 'Fuentes Admin.' : yearData.obtencionDirecta > yearData.estadisticasDerivadas ? 'Obtenci√≥n Directa' : 'Estad√≠sticas Derivadas'}</div>
                            <div style="font-size: 0.8em; color: #7f8c8d;">${Math.max(yearData.fuentesAdministrativas, yearData.obtencionDirecta, yearData.estadisticasDerivadas).toFixed(1)}%</div>
                        </div>
                    </div>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3 class="chart-title">üìä Distribuci√≥n de Dominios Estad√≠sticos</h3>
                            <canvas id="year-${year}-domain-chart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3 class="chart-title">üîß Metodolog√≠as Utilizadas</h3>
                            <canvas id="year-${year}-methodology-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="chart-title">üèõÔ∏è Top 10 Organismos - ${year}</h3>
                        <div class="top-organismos" id="year-${year}-top-organismos"></div>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="chart-title">üìã Detalle por M√©tricas</h3>
                        <div class="methodology-grid">
                            <div class="methodology-item">
                                <div class="methodology-label">Demograf√≠a</div>
                                <div class="methodology-value">${yearData.demografia}%</div>
                            </div>
                            <div class="methodology-item">
                                <div class="methodology-label">Estad√≠sticas Econ√≥micas</div>
                                <div class="methodology-value">${yearData.economica}%</div>
                            </div>
                            <div class="methodology-item">
                                <div class="methodology-label">Medio Ambiente</div>
                                <div class="methodology-value">${yearData.ambiente}%</div>
                            </div>
                            <div class="methodology-item">
                                <div class="methodology-label">Metodolog√≠as</div>
                                <div class="methodology-value">${yearData.metodologia}%</div>
                            </div>
                            <div class="methodology-item">
                                <div class="methodology-label">Obtenci√≥n Directa</div>
                                <div class="methodology-value">${yearData.obtencionDirecta}%</div>
                            </div>
                            <div class="methodology-item">
                                <div class="methodology-label">Fuentes Administrativas</div>
                                <div class="methodology-value">${yearData.fuentesAdministrativas}%</div>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(section);
                
                createYearCharts(year, yearData);
            });
        }

        function createYearCharts(year, yearData) {
            const domainCtx = document.getElementById(`year-${year}-domain-chart`).getContext('2d');
            new Chart(domainCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Demograf√≠a', 'Estad√≠sticas Econ√≥micas', 'Medio Ambiente', 'Metodolog√≠as'],
                    datasets: [{
                        data: [yearData.demografia, yearData.economica, yearData.ambiente, yearData.metodologia],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: `Distribuci√≥n de Dominios - ${year}`
                        }
                    }
                }
            });

            const methodologyCtx = document.getElementById(`year-${year}-methodology-chart`).getContext('2d');
            new Chart(methodologyCtx, {
                type: 'bar',
                data: {
                    labels: ['Obtenci√≥n Directa', 'Fuentes Admin.', 'Estad√≠sticas Derivadas', 'Infraestructura', 'Otras'],
                    datasets: [{
                        label: 'Porcentaje (%)',
                        data: [
                            yearData.obtencionDirecta,
                            yearData.fuentesAdministrativas,
                            yearData.estadisticasDerivadas,
                            yearData.infraestructura,
                            yearData.otrasMetodologias
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: `Metodolog√≠as Utilizadas - ${year}`
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 50,
                            title: {
                                display: true,
                                text: 'Porcentaje (%)'
                            }
                        }
                    }
                }
            });

            const topOrgContainer = document.getElementById(`year-${year}-top-organismos`);
            yearData.topOrganismos.forEach(org => {
                const orgCard = document.createElement('div');
                orgCard.className = 'org-card';
                orgCard.innerHTML = `
                    <div class="org-name">${org.name}</div>
                    <div class="org-count">${org.count} operaciones</div>
                    <div class="org-percent">(${org.percent}% del total del a√±o)</div>
                `;
                topOrgContainer.appendChild(orgCard);
            });
        }

        function initTotalCharts() {
            const totalYearlyCtx = document.getElementById('totalYearlyChart').getContext('2d');
            new Chart(totalYearlyCtx, {
                type: 'line',
                data: {
                    labels: data.years,
                    datasets: [{
                        label: 'Total Operaciones',
                        data: data.years.map(year => data.yearlyData[year].total),
                        borderWidth: 3,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evoluci√≥n del Total de Operaciones (2014-2023)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 200,
                            title: {
                                display: true,
                                text: 'Cantidad de Operaciones'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'A√±o'
                            }
                        }
                    }
                }
            });

            const totalServiceCtx = document.getElementById('totalServiceChart').getContext('2d');
            new Chart(totalServiceCtx, {
                type: 'pie',
                data: {
                    labels: ['INE (716)', 'Otros Organismos (2,650)'],
                    datasets: [{
                        data: [716, 2650],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'Distribuci√≥n Total por Servicio Estad√≠stico'
                        }
                    }
                }
            });

            const totalDomainEvolutionCtx = document.getElementById('totalDomainEvolutionChart').getContext('2d');
            new Chart(totalDomainEvolutionCtx, {
                type: 'line',
                data: {
                    labels: data.years,
                    datasets: [
                        {
                            label: 'Demograf√≠a',
                            data: data.years.map(year => data.yearlyData[year].demografia),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Estad√≠sticas Econ√≥micas',
                            data: data.years.map(year => data.yearlyData[year].economica),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Medio Ambiente',
                            data: data.years.map(year => data.yearlyData[year].ambiente),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Metodolog√≠as',
                            data: data.years.map(year => data.yearlyData[year].metodologia),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evoluci√≥n de Dominios Tem√°ticos (2014-2023)'
                        },
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 80,
                            title: {
                                display: true,
                                text: 'Porcentaje (%)'
                            },
                            ticks: {
                                stepSize: 10
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'A√±o'
                            }
                        }
                    }
                }
            });

            const totalMethodologyEvolutionCtx = document.getElementById('totalMethodologyEvolutionChart').getContext('2d');
            new Chart(totalMethodologyEvolutionCtx, {
                type: 'line',
                data: {
                    labels: data.years,
                    datasets: [
                        {
                            label: 'Obtenci√≥n Directa',
                            data: data.years.map(year => data.yearlyData[year].obtencionDirecta),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Fuentes Administrativas',
                            data: data.years.map(year => data.yearlyData[year].fuentesAdministrativas),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Estad√≠sticas Derivadas',
                            data: data.years.map(year => data.yearlyData[year].estadisticasDerivadas),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Infraestructura',
                            data: data.years.map(year => data.yearlyData[year].infraestructura),
                            borderWidth: 3,
                            tension: 0.3,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evoluci√≥n de Metodolog√≠as (2014-2023)'
                        },
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 60,
                            title: {
                                display: true,
                                text: 'Porcentaje (%)'
                            },
                            ticks: {
                                stepSize: 10
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'A√±o'
                            }
                        }
                    }
                }
            });

            const totalTopOrganismos = [
                {name: "Instituto Nacional de Estad√≠stica (INE)", count: 716, percent: 21.3},
                {name: "Ministerio de Salud P√∫blica y Bienestar Social", count: 434, percent: 12.9},
                {name: "Ministerio de Econom√≠a y Finanzas (MEF)", count: 167, percent: 5.0},
                {name: "Ministerio de Trabajo, Empleo y Seguridad Social", count: 151, percent: 4.5},
                {name: "Ministerio de Obras P√∫blicas y Comunicaciones", count: 146, percent: 4.3},
                {name: "Universidad Nacional de Asunci√≥n (UNA)", count: 129, percent: 3.8},
                {name: "Ministerio del Interior (MDI)", count: 66, percent: 2.0},
                {name: "Secretar√≠a Nacional Antidrogas (SENAD)", count: 60, percent: 1.8},
                {name: "Secretar√≠a Nacional de Turismo (SENATUR)", count: 61, percent: 1.8},
                {name: "Servicio Nacional de Calidad y Salud Animal", count: 57, percent: 1.7}
            ];

            const totalTopContainer = document.getElementById('totalTopOrganismos');
            totalTopOrganismos.forEach(org => {
                const orgCard = document.createElement('div');
                orgCard.className = 'org-card';
                orgCard.innerHTML = `
                    <div class="org-name">${org.name}</div>
                    <div class="org-count">${org.count} operaciones</div>
                    <div class="org-percent">(${org.percent}% del total)</div>
                `;
                totalTopContainer.appendChild(orgCard);
            });

            const totalTableBody = document.getElementById('totalYearlyTable');
            data.years.forEach(year => {
                const yearData = data.yearlyData[year];
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${year}</strong></td>
                    <td>${yearData.total}</td>
                    <td>${yearData.ine} (${((yearData.ine/yearData.total)*100).toFixed(1)}%)</td>
                    <td>${yearData.others} (${((yearData.others/yearData.total)*100).toFixed(1)}%)</td>
                    <td>${yearData.difusionPublica}%</td>
                    <td>${yearData.demografia}%</td>
                    <td>${yearData.fuentesAdministrativas}%</td>
                `;
                totalTableBody.appendChild(row);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            initTotalCharts();
            createYearSections();
        });
    </script>
</body>
</html>
